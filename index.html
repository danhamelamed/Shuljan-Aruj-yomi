}
.section {
margin-bottom: 20px;
      white-space: pre-wrap;
}
.label {
font-weight: bold;
@@ -37,67 +38,94 @@
.toolbar {
display: flex;
flex-wrap: wrap;
      justify-content: space-between;
      margin-bottom: 20px;
gap: 10px;
      margin-bottom: 20px;
}
    .toolbar select, .toolbar button {
      padding: 8px;
      font-size: 1em;
    button {
      padding: 10px 15px;
      font-size: 14px;
      cursor: pointer;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 5px;
}
    .turim-marquee {
      background-color: #e2f0d9;
      padding: 0.5em;
      font-size: 1em;
      white-space: nowrap;
      overflow: hidden;
      box-sizing: border-box;
    button:hover {
      background-color: #0056b3;
}
    .turim-marquee span {
      display: inline-block;
      padding-left: 100%;
      animation: marquee 20s linear infinite;
    select {
      padding: 10px;
      font-size: 14px;
}
    @keyframes marquee {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    .turim-banner {
      display: flex;
      justify-content: center;
      gap: 15px;
      padding: 10px;
      background-color: #eee;
      overflow-x: auto;
      white-space: nowrap;
    }
    .turim-banner div {
      flex: 0 0 auto;
      font-weight: bold;
}
</style>
</head>
<body>
<header>Shulján Aruj Yomi</header>
  <div class="turim-marquee"><span>Oraj Jaim • Ioré Deá • Even Haézer • Joshen Mishpat • Oraj Jaim • Ioré Deá • Even Haézer • Joshen Mishpat •</span></div>

  <div class="turim-banner">
    <div>Oraj Jaim</div>
    <div>Ioré Deá</div>
    <div>Even HaEzer</div>
    <div>Joshen Mishpat</div>
  </div>

<div class="container">
<div class="toolbar">
      <select id="simanSelector" onchange="changeSiman()">
        <option value="1">Simán 1</option>
        <option value="2">Simán 2</option>
        <option value="3">Simán 3</option>
        <option value="4">Simán 4</option>
      </select>
      <button onclick="nextSeif()">Siguiente Seif</button>
      <label for="simanSelector">Simán:</label>
      <select id="simanSelector" onchange="changeSiman()"></select>
      <button onclick="prevSiman()">Simán Anterior</button>
      <button onclick="nextSiman()">Siguiente Simán</button>
<button onclick="downloadPDF()">Descargar PDF</button>
</div>

    <div class="section"><span class="label">Hebreo:</span><div id="hebrew"></div></div>
    <div class="section"><span class="label">Transliteración:</span><div id="transliteration"></div></div>
    <div class="section"><span class="label">Traducción:</span><div id="translation"></div></div>
    <div class="section"><span class="label">Explicación:</span><div id="explanation"></div></div>
<div id="status"></div>

    <div class="section">
      <span class="label">Hebreo:</span>
      <div id="hebrew"></div>
    </div>
    <div class="section">
      <span class="label">Transliteración y Fonética:</span>
      <div id="transliteration"></div>
    </div>
    <div class="section">
      <span class="label">Traducción:</span>
      <div id="translation"></div>
    </div>
    <div class="section">
      <span class="label">Explicación:</span>
      <div id="explanation"></div>
    </div>
</div>

<script>
let currentSiman = 1;
    let currentSeif = 1;

    const simanSelector = document.getElementById('simanSelector');
const hebrewDiv = document.getElementById('hebrew');
const transliterationDiv = document.getElementById('transliteration');
const translationDiv = document.getElementById('translation');
const explanationDiv = document.getElementById('explanation');
const statusDiv = document.getElementById('status');
    const simanSelector = document.getElementById('simanSelector');

    async function loadSeif() {
    function formatSeifim(text) {
      return text.replace(/\(\d+\)/g, '\n($1)').replace(/\n/g, '\n\n');
    }

    async function loadSiman() {
statusDiv.innerText = "Cargando...";
hebrewDiv.innerText = "";
transliterationDiv.innerText = "";
@@ -108,56 +136,73 @@
const response = await fetch('https://shuljan-aruj-api.danfuenteslopez.workers.dev/', {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ siman: currentSiman, seif: currentSeif })
          body: JSON.stringify({ siman: currentSiman })
});

        const text = await response.text();
        try {
          const data = JSON.parse(text);
        if (!response.ok) {
          const error = await response.text();
          statusDiv.innerText = "Error en el servidor.";
          console.error(error);
          return;
        }

          if (!data || (!data.hebrew && !data.transliteration && !data.translation && !data.explanation)) {
            statusDiv.innerText = `No hay más contenido en el Seif ${currentSeif}.`;
            return;
          }
        const data = await response.json();

          hebrewDiv.innerText = data.hebrew || "";
          transliterationDiv.innerText = data.transliteration || "";
          translationDiv.innerText = data.translation || "";
          explanationDiv.innerText = data.explanation || "";
        hebrewDiv.innerText = formatSeifim(data.hebrew || "");
        transliterationDiv.innerText = formatSeifim(data.transliteration || "");
        translationDiv.innerText = formatSeifim(data.translation || "").replace(/\b[A-Za-z]{3,}\b/g, (word) => {
          // Heurística: Si es inglés largo, ignorar (mejora parcial de idioma)
          return /[áéíóúñü]/i.test(word) ? word : word;
        });
        explanationDiv.innerText = formatSeifim(data.explanation || "");

          statusDiv.innerText = `Simán ${currentSiman}, Seif ${currentSeif}`;
        } catch (parseError) {
          statusDiv.innerText = "Respuesta no válida del servidor.";
          console.error("Respuesta cruda:", text);
        }
      } catch (error) {
        console.error(error);
        statusDiv.innerText = "";
      } catch (err) {
statusDiv.innerText = "Error de conexión.";
        console.error(err);
}
}

    function nextSeif() {
      currentSeif++;
      loadSeif();
    }

function changeSiman() {
currentSiman = parseInt(simanSelector.value);
      currentSeif = 1;
      loadSeif();
      loadSiman();
}

    function downloadPDF() {
      const contenido = `Simán ${currentSiman}, Seif ${currentSeif}\n\nHebreo:\n${hebrewDiv.innerText}\n\nTransliteración:\n${transliterationDiv.innerText}\n\nTraducción:\n${translationDiv.innerText}\n\nExplicación:\n${explanationDiv.innerText}`;
    function prevSiman() {
      if (currentSiman > 1) {
        currentSiman--;
        simanSelector.value = currentSiman;
        loadSiman();
      }
    }

    function nextSiman() {
      currentSiman++;
      simanSelector.value = currentSiman;
      loadSiman();
    }

      const blob = new Blob([contenido], { type: 'application/pdf' });
    function downloadPDF() {
      const text = `Shulján Aruj Yomi - Simán ${currentSiman}\n\nHEBREO:\n${hebrewDiv.innerText}\n\nFONÉTICA:\n${transliterationDiv.innerText}\n\nTRADUCCIÓN:\n${translationDiv.innerText}\n\nEXPLICACIÓN:\n${explanationDiv.innerText}`;
      const blob = new Blob([text], { type: 'application/pdf' });
const link = document.createElement('a');
link.href = URL.createObjectURL(blob);
      link.download = `shuljan_aruj_siman${currentSiman}_seif${currentSeif}.pdf`;
      link.download = `shuljan-aruj-siman-${currentSiman}.pdf`;
link.click();
}

    loadSeif();
    function populateSimanim(max = 200) {
      for (let i = 1; i <= max; i++) {
        const option = document.createElement('option');
        option.value = i;
        option.text = `Simán ${i}`;
        simanSelector.appendChild(option);
      }
      simanSelector.value = currentSiman;
    }

    populateSimanim();
    loadSiman();
</script>
</body>
</html>
